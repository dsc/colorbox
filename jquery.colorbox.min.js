// ColorBox v1.3.17.3 - a full featured, light-weight, customizable lightbox based on jQuery 1.3+
// Copyright (c) 2011 Jack Moore - jack@colorpowered.com
// Contributions by David Schoonover -- dsc@less.ly
// Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
(function(a,b,c){function bn(a,b){if(!a)return G;var c=X+a,d=F.length,e=c<0?d+c%d:c%d,f=e===c||R.loop,g=(a<0?j:k)+(b?"."+b:"");if(!$&&F[1]&&f){var h=bi(g,null,{colorboxNext:F.eq(e)});h.isDefaultPrevented()||(X=e,bc.load())}return G}function bm(b){if(!_){W=b,bh(),F=a(W),X=0,R.rel!=="nofollow"&&(F=a("."+h).filter(function(){var b=a.data(this,f).rel||this.rel;return b===R.rel}),X=F.index(W),X===-1&&(F=F.add(W),X=F.length-1)),G=F.eq(X);if(!Z){Z=$=!0,y.show();if(R.returnFocus)try{W.blur(),a(W).one(o,function(){try{this.focus()}catch(a){}})}catch(c){}x.css({opacity:+R.opacity,cursor:R.overlayClose?"pointer":"auto"}).show(),R.w=bf(R.initialWidth,"x"),R.h=bf(R.initialHeight,"y"),bc.position(),t&&v.bind("resize."+u+" scroll."+u,function(){x.css({width:v.width(),height:v.height(),top:v.scrollTop(),left:v.scrollLeft()})}).trigger("resize."+u),bi(i,R.onOpen),Q.add(K).hide(),P.html(R.close).show()}bc.load(!0)}}function bl(){var a,b=g+"Slideshow_",c="click."+g,d,e,f;R.slideshow&&F[1]?(d=function(){var d=bi(q,null);d.isDefaultPrevented()||(M.text(R.slideshowStop).unbind(c).bind(m,function(){if(X<F.length-1||R.loop)a=setTimeout(bj,R.slideshowSpeed)}).bind(l,function(){clearTimeout(a)}).one(c+" "+n,e),y.removeClass(b+"off").addClass(b+"on"),a=setTimeout(bj,R.slideshowSpeed))},e=function(){var e=bi(r,null);e.isDefaultPrevented()||(clearTimeout(a),M.text(R.slideshowStart).unbind([m,l,n,c].join(" ")).one(c,d),y.removeClass(b+"on").addClass(b+"off"))},R.slideshowAuto?d():e()):y.removeClass(b+"off "+b+"on")}function bi(b,c,d){var e=new jQuery.Event(b);d=a.extend({colorboxCurrent:G},d||{}),a.extend(e,d),c&&G.one(b,c),G.trigger(e),e.namespace&&e.type.slice(0,g.length)===g&&(e.namespace="",G.trigger(e));return e}function bh(b){R=a.extend({},a.data(W,f));for(b in R)a.isFunction(R[b])&&b.substring(0,2)!=="on"&&(R[b]=R[b].call(W));R.rel=R.rel||W.rel||"nofollow",R.href=R.href||a(W).attr("href"),R.title=R.title||W.title,typeof R.href=="string"&&(R.href=a.trim(R.href))}function bg(a){return R.photo||/\.(gif|png|jpg|jpeg|bmp)(?:\?([^#]*))?(?:#(\.*))?$/i.test(a)}function bf(a,b){return Math.round((/%/.test(a)?(b==="x"?v.width():v.height())/100:1)*parseInt(a,10))}function be(a,b){var c=d.call(arguments),a=c.shift(),b=c.shift();return function(){return a.apply(b,c.concat(d.call(arguments)))}}function bd(c,d){var e=b.createElement("div");c&&(e.id=g+c),e.style.cssText=d||"";return a(e)}var d=[].slice,e={transition:"elastic",speed:300,width:!1,initialWidth:"600",innerWidth:!1,maxWidth:!1,height:!1,initialHeight:"450",innerHeight:!1,maxHeight:!1,scalePhotos:!0,scrolling:!0,inline:!1,html:!1,iframe:!1,fastIframe:!0,photo:!1,href:!1,title:!1,rel:!1,opacity:.9,preloading:!0,current:"image {current} of {total}",previous:"previous",next:"next",close:"close",open:!1,returnFocus:!0,loop:!0,slideshow:!1,slideshowAuto:!0,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",onOpen:!1,onLoad:!1,onComplete:!1,onCleanup:!1,onClosed:!1,overlayClose:!0,escKey:!0,arrowKey:!0,top:!1,bottom:!1,left:!1,right:!1,fixed:!1,data:!1},f="colorbox",g="cbox",h=g+"Element",i=g+"_open",j=g+"_prev",k=g+"_next",l=g+"_load",m=g+"_complete",n=g+"_cleanup",o=g+"_closed",p=g+"_purge",q=g+"_slideshow_start",r=g+"_slideshow_stop",s=a.browser.msie&&!a.support.opacity,t=s&&a.browser.version<7,u=g+"_IE6",v=a(c),w=a(b),x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ba,bb,bc,bj=be(bn,this,1,"slideshow"),bk=be(bn,this,-1,"slideshow");bc=a.fn[f]=a[f]=function(b,c){var d=this;b=b||{};if(!d[0]){if(d.selector)return d;d=a("<a/>"),b.open=!0}c&&(b.onComplete=c),d.each(function(){a.data(this,f,a.extend({},a.data(this,f)||e,b)),a(this).addClass(h)}),(a.isFunction(b.open)&&b.open.call(d)||b.open)&&bm(d[0]);return d},bc.init=function(){y=bd().attr({id:f,"class":s?g+(t?"IE6":"IE"):""}),x=bd("Overlay",t?"position:absolute":"").hide(),z=bd("Wrapper"),A=bd("Content").append(H=bd("LoadedContent","width:0; height:0; overflow:hidden"),J=bd("LoadingOverlay").add(bd("LoadingGraphic")),K=bd("Title"),L=bd("Current"),N=bd("Next"),O=bd("Previous"),M=bd("Slideshow"),P=bd("Close")),z.append(bd().append(bd("TopLeft"),B=bd("TopCenter"),bd("TopRight")),bd(!1,"clear:left").append(C=bd("MiddleLeft"),A,D=bd("MiddleRight")),bd(!1,"clear:left").append(bd("BottomLeft"),E=bd("BottomCenter"),bd("BottomRight"))).children().children().css({"float":"left"}),I=bd(!1,"position:absolute; width:9999px; visibility:hidden; display:none"),a("body").prepend(x,y.append(z,I)),A.children().hover(function(){a(this).addClass("hover")},function(){a(this).removeClass("hover")}).addClass("hover"),S=B.height()+E.height()+A.outerHeight(!0)-A.height(),T=C.width()+D.width()+A.outerWidth(!0)-A.width(),U=H.outerHeight(!0),V=H.outerWidth(!0),y.css({"padding-bottom":S,"padding-right":T}).hide(),w.bind(i,bl),N.click(function(){bc.next()}),O.click(function(){bc.prev()}),P.click(function(){bc.close()}),Q=N.add(O).add(L).add(M),A.children().removeClass("hover"),x.click(function(){R.overlayClose&&bc.close()}),w.bind("keydown."+g,function(a){var b=a.keyCode;Z&&R.escKey&&b===27&&(a.preventDefault(),bc.close()),Z&&R.arrowKey&&F[1]&&(b===37?(a.preventDefault(),O.click()):b===39&&(a.preventDefault(),N.click()))})},bc.remove=function(){y.add(x).remove(),a("."+h).removeData(f).removeClass(h)},bc.position=function(a,c){function f(a){B[0].style.width=E[0].style.width=A[0].style.width=a.style.width,J[0].style.height=J[1].style.height=A[0].style.height=C[0].style.height=D[0].style.height=a.style.height}var d=0,e=0;v.unbind("resize."+g),y.hide(),R.fixed&&!t?y.css({position:"fixed"}):(d=v.scrollTop(),e=v.scrollLeft(),y.css({position:"absolute"})),R.right!==!1?e+=Math.max(v.width()-R.w-V-T-bf(R.right,"x"),0):R.left!==!1?e+=bf(R.left,"x"):e+=Math.round(Math.max(v.width()-R.w-V-T,0)/2),R.bottom!==!1?d+=Math.max(b.documentElement.clientHeight-R.h-U-S-bf(R.bottom,"y"),0):R.top!==!1?d+=bf(R.top,"y"):d+=Math.round(Math.max(b.documentElement.clientHeight-R.h-U-S,0)/2),y.show(),a=y.width()===R.w+V&&y.height()===R.h+U?0:a||0,z[0].style.width=z[0].style.height="9999px",y.dequeue().animate({width:R.w+V,height:R.h+U,top:d,left:e},{duration:a,complete:function(){f(this),$=!1,z[0].style.width=R.w+V+T+"px",z[0].style.height=R.h+U+S+"px",c&&c(),setTimeout(function(){v.bind("resize."+g,bc.position)},1)},step:function(){f(this)}})},bc.resize=function(a){if(Z){a=a||{},a.width&&(R.w=bf(a.width,"x")-V-T),a.innerWidth&&(R.w=bf(a.innerWidth,"x")),H.css({width:R.w}),a.height&&(R.h=bf(a.height,"y")-U-S),a.innerHeight&&(R.h=bf(a.innerHeight,"y"));if(!a.innerHeight&&!a.height){var b=H.wrapInner("<div style='overflow:auto'></div>").children();R.h=b.height(),b.replaceWith(b.children())}H.css({height:R.h}),bc.position(R.transition==="none"?0:R.speed)}},bc.prep=function(b){function h(){R.h=R.h||H.height(),R.h=R.mh&&R.mh<R.h?R.mh:R.h;return R.h}function e(){R.w=R.w||H.width(),R.w=R.mw&&R.mw<R.w?R.mw:R.w;return R.w}if(!!Z){var c,d=R.transition==="none"?0:R.speed;H.remove(),H=bd("LoadedContent").append(b),H.hide().appendTo(I.show()).css({width:e(),overflow:R.scrolling?"auto":"hidden"}).css({height:h()}).prependTo(A),I.hide(),a(Y).css({"float":"none"}),t&&a("select").not(y.find("select")).filter(function(){return this.style.visibility!=="hidden"}).css({visibility:"hidden"}).one(n,function(){this.style.visibility="inherit"}),c=function(){function l(){s&&y[0].style.removeAttribute("filter")}var b,c,e,h,i=F.length,j,k;!Z||(k=function(){clearTimeout(bb),J.hide(),bi(m,R.onComplete)},s&&Y&&H.fadeIn(100),K.html(R.title).add(H).show(),i>1?(typeof R.current=="string"&&L.html(R.current.replace("{current}",X+1).replace("{total}",i)).show(),N[R.loop||X<i-1?"show":"hide"]().html(R.next),O[R.loop||X?"show":"hide"]().html(R.previous),b=X?F[X-1]:F[i-1],e=X<i-1?F[X+1]:F[0],R.slideshow&&M.show(),R.preloading&&(h=a.data(e,f).href||e.href,c=a.data(b,f).href||b.href,h=a.isFunction(h)?h.call(e):h,c=a.isFunction(c)?c.call(b):c,bg(h)&&(a("<img/>")[0].src=h),bg(c)&&(a("<img/>")[0].src=c))):Q.hide(),R.iframe?(j=a("<iframe/>").addClass(g+"Iframe")[0],R.fastIframe?k():a(j).one("load",k),j.name=g+ +(new Date),j.src=R.href,R.scrolling||(j.scrolling="no"),s&&(j.frameBorder=0,j.allowTransparency="true"),a(j).appendTo(H).one(p,function(){j.src="//about:blank"})):k(),R.transition==="fade"?y.fadeTo(d,1,l):l())},R.transition==="fade"?y.fadeTo(d,0,function(){bc.position(0,c)}):bc.position(d,c)}},bc.load=function(b){var c,d,e=bc.prep;$=!0,Y=!1,W=F[X],G=F.eq(X),b||bh(),bi(p),bi(l,R.onLoad),R.h=R.height?bf(R.height,"y")-U-S:R.innerHeight&&bf(R.innerHeight,"y"),R.w=R.width?bf(R.width,"x")-V-T:R.innerWidth&&bf(R.innerWidth,"x"),R.mw=R.w,R.mh=R.h,R.maxWidth&&(R.mw=bf(R.maxWidth,"x")-V-T,R.mw=R.w&&R.w<R.mw?R.w:R.mw),R.maxHeight&&(R.mh=bf(R.maxHeight,"y")-U-S,R.mh=R.h&&R.h<R.mh?R.h:R.mh),c=R.href,bb=setTimeout(function(){J.show()},100),R.inline?(bd().hide().insertBefore(a(c)[0]).one(p,function(){a(this).replaceWith(H.children())}),e(a(c))):R.iframe?e(" "):R.html?e(R.html):bg(c)?(a(Y=new Image).addClass(g+"Photo").error(function(){R.title=!1,e(bd("Error").text("This image could not be loaded"))}).load(function(){var a;Y.onload=null,R.scalePhotos&&(d=function(){Y.height-=Y.height*a,Y.width-=Y.width*a},R.mw&&Y.width>R.mw&&(a=(Y.width-R.mw)/Y.width,d()),R.mh&&Y.height>R.mh&&(a=(Y.height-R.mh)/Y.height,d())),R.h&&(Y.style.marginTop=Math.max(R.h-Y.height,0)/2+"px"),F[1]&&(X<F.length-1||R.loop)&&(Y.style.cursor="pointer",Y.onclick=function(){bc.next()}),s&&(Y.style.msInterpolationMode="bicubic"),setTimeout(function(){e(Y)},1)}),setTimeout(function(){Y.src=c},1)):c&&I.load(c,R.data,function(b,c,d){e(c==="error"?bd("Error").text("Request unsuccessful: "+d.statusText):a(this).contents())})},bc.navigate=function(a){return bn(a,"user")},bc.next=be(bn,this,1,"user"),bc.prev=be(bn,this,-1,"user"),bc.close=function(){Z&&!_&&(_=!0,Z=!1,bi(n,R.onCleanup),v.unbind("."+g+" ."+u),x.fadeTo(200,0),y.stop().fadeTo(300,0,function(){y.add(x).css({opacity:1,cursor:"auto"}).hide(),bi(p),H.remove(),setTimeout(function(){_=!1,bi(o,R.onClosed)},1)}))},bc.element=function(){return a(W)},bc.settings=e,ba=function(a){a.button!==0&&typeof a.button!="undefined"||a.ctrlKey||a.shiftKey||a.altKey||(a.preventDefault(),bm(this))},a.fn.delegate?w.delegate("."+h,"click",ba):a("."+h).live("click",ba),a(bc.init)})(jQuery,document,this)